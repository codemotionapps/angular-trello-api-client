angular.module("angular-trello-api-client",[]),angular.module("angular-trello-api-client").provider("TrelloClient",function(){var e;e={applicationKey:null,auth:{name:null,endpoint:"https://trello.com"},apiEndpoint:"https://api.trello.com",intentEndpoint:"https://trello.com",version:1,expiration:"never",storageKey:"trello_token"},this.init=function(n){return null!=n?angular.extend(e,n):void 0},this.$get=function(n,t,o,r){var i,a,u,l,c,s,p;return u=e.apiEndpoint+"/"+e.version+"/",s=null,l=o.localStorage,null!=l?(c=function(){return l[e.storageKey]},p=function(n){return null===n?delete l[e.storageKey]:l[e.storageKey]=n}):c=p=function(){},a=function(n){var t;return t={response_type:"token",key:e.applicationKey},angular.extend(t,n),e.auth.endpoint+"/"+e.version+"/authorize?"+r(t)},i={},i.version=function(){return e.version},i.key=function(){return e.applicationKey},i.token=function(){return s},i.authorized=function(){return null!=s},i.deauthorize=function(){return s=null,p(s)},i.authorize=function(t){var r,u,l,d,f,h,v,g,w,y,m,x,k;if(f={type:"redirect",persist:!0,interactive:!0,scope:{read:!0,write:!0,account:!1},expiration:"30days"},angular.extend(f,t),w=/[&#]?token=([0-9a-f]{64})/,null==s&&(s=c()),null==s&&(s=null!=(v=w.exec(n.hash))?v[1]:void 0),r=function(n){var t;return window.removeEventListener("message",r),n.origin===e.auth.endpoint?(null!=(t=n.source)&&t.close(),null!=n.data&&n.data.length>4?(s=n.data,p(s),"function"==typeof f.success?f.success():void 0):(s=null,p(s),"function"==typeof f.error?f.error():void 0)):void 0},i.authorized())return p(s),n.hash=n.hash.replace(w,""),"function"==typeof f.success?f.success():void 0;if(!f.interactive)return"function"==typeof f.error?f.error():void 0;switch(y=function(){var e,n;e=f.scope,n=[];for(l in e)x=e[l],x&&n.push(l);return n}().join(","),f.type){case"popup":k=420,u=470,d=window.screenX+(window.innerWidth-k)/2,m=window.screenY+(window.innerHeight-u)/2,h=null!=(g=/^[a-z]+:\/\/[^\/]*/.exec(location))?g[0]:void 0,"function"==typeof window.addEventListener&&window.addEventListener("message",r,!1),window.open(a({return_url:h,callback_method:"postMessage",scope:y,expiration:f.expiration,name:f.name}),"trello","width="+k+",height="+u+",left="+d+",top="+m);break;default:o.location=a({redirect_uri:location.href,callback_method:"fragment",scope:y,expiration:f.expiration,name:f.name})}},i}});